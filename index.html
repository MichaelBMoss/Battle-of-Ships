<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
    <title>Document</title>

    <style>
        body {
            background-color: #0332ac;
            width: 99vw;
            height: 97vh;
        }

        #entire {
            width: 100%;
            height: 100%;
            display: flex;
        }

        #left-side-section {
            width: 8%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #logo-div {
            width: 100%;
            height: 20%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #logo {
            width: 90%;
        }

        #main-section {
            width: 90%;
            height: 100%;
            display: flex;
            align-items: center;
        }

        #info-panel {
            background-color: #1f1f1f;
            border-radius: 5%;;
            border: solid 5px silver;
            width: 25%;
            height: 50%;
            margin-left: 4%;
        }

        #gameboard {
            height: 70%;
            aspect-ratio: 1 / 1;
            background-image: url('assets/gameboard-background.png');
            background-size: cover;
            margin-right: 1%;
            margin-left: 1%;
            border: solid 5px silver;
        }

        .row {
            height: 10%;
        }

        .square {
            display: inline-block;
            height: 100%;
            width:10%;
            border: rgba(0, 0, 0, .4) solid 1px;
            margin: -1px;
        }

        #ship-panel {
            background-color: #1f1f1f;
            border-radius: 5%;;
            border: solid 5px silver;
            width: 20%;
            height: 50%;
        }

    </style>
</head>


<body>
    <div id="entire">
        <div id="left-side-section">
            <div id="logo-div">
                <img id="logo" src="assets/battle-of-ships-logo.png">
            </div>
        </div>
        <div id="main-section"></div>
    </div>
</body>


<script>

    console.log('script working');

    const mainEl = document.getElementById('main-section')
    console.log(mainEl)
    let gameboardEl;
    let gridObject;
    let orientation;
    let firstSquare;
    let colNum;
    let rowNum;
    let randRow;
    let randCol;
    let noneCount;
    const ships = [
        {name: 'Aircraft Carrier', size: 5, image: 'assets/aircraft-carrier.png',},
        {name: 'Battleship', size: 4, image: 'assets/battleship.png',},
        {name: 'Submarine', size: 3, image: 'assets/submarine.png',},
        {name: 'Cruiser', size: 3, image: 'assets/cruiser.png',},
        {name: 'Destroyer', size: 2, image: 'assets/destroyer.png',},
    ];
    
    function initialize() {
        createMainSectionStructure();
        createGameGridAndGridObject();
        placeShips();
    };

    function clearMainSectionEl() {
        const mainContents = mainEl.querySelectorAll('*');
        mainContents.forEach(element => element.remove());
    }

    function createMainSectionStructure() {
        clearMainSectionEl();
        let infoPanel = document.createElement('div');
        infoPanel.id = "info-panel";
        mainEl.appendChild(infoPanel);
        gameboardEl = document.createElement('div');
        gameboardEl.id = "gameboard";
        mainEl.appendChild(gameboardEl);
        let shipPanel = document.createElement('div')
        shipPanel.id = "ship-panel";
        mainEl.appendChild(shipPanel);
    };

    function createGameGridAndGridObject() {
    gridObject = {};
    let id = 0;
    for (let i = 1; i <= 10; i++) {
        let rowEl = document.createElement('div');
        rowEl.className = "row";
        gameboardEl.appendChild(rowEl);
        gridObject[i] = {};
        for (let j = 1; j <= 10; j++) {
            let squareEl = document.createElement('div');
            squareEl.className = "square";
            id++;
            squareEl.id = id;
            rowEl.appendChild(squareEl);
            gridObject[i][j] = 'none';
            squareEl.addEventListener('click', () => {
                gameboardClick(i, j);
            }); 
        };
    };
};

    function placeShips() {
        for (let ship of ships) {
            findOpenSpot(ship);
        };
    };

    function setOrientation() {
        let random0to1 = Math.floor(Math.random() * 2);
        if (random0to1 == 0) { 
            orientation = "vertical";
        } else if (random0to1 == 1) { 
            orientation = "horizontal";
        };
    }

    function findOpenSpot(ship) {
        setOrientation();
        if (orientation == 'vertical') {
            randRow = Math.floor(Math.random() * (10 - ship.size) + 1);
            randCol = Math.floor(Math.random() * 10 + 1);
        } else if (orientation == 'horizontal') {
            randCol = Math.floor(Math.random() * (10 - ship.size) + 1);
            randRow = Math.floor(Math.random() * 10 + 1);
        };
        noneCount = 0;
        if (orientation == 'vertical') {
            for (let k = 0; k < ship.size; k++) {
                if (gridObject[randRow + k][randCol] == 'none') {
                noneCount++
                };
            };
            if (ship.size == noneCount++) {
                for (let m = 0; m < ship.size; m++) {
                    gridObject[randRow + m][randCol] = ship.name;
                }
            } else {
                findOpenSpot(ship);
            };
        };
        if (orientation == 'horizontal') {
            for (let w = 0; w < ship.size; w++) {
                if (gridObject[randRow][randCol + w] == 'none') {
                noneCount++
                };
            };
            if (ship.size == noneCount++) {
                for (let b = 0; b < ship.size; b++) {
                    gridObject[randRow][randCol + b] = ship.name;
                };
            } else {
                findOpenSpot(ship);
            };   
        };
        console.log(gridObject);
    };

    function gameboardClick(squareEl) {

    };


    initialize();

</script>

</html>