<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pixelify+Sans&display=swap" rel="stylesheet">

    <title>Document</title>

    <style>
        body {
            background-image: url('assets/fleet-background.jpg');
            background-size: cover;
            width: 99vw;
            height: 97vh;
        }

        #info-panel p {
            margin-right: 10%;
            margin-left: 16%;
        }

        #entire {
            width: 100%;
            height: 100%;
            display: flex;
        }

        #left-side-section {
            width: 8%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #logo-div {
            width: 100%;
            height: 20%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #logo {
            width: 100%;
        }

        #main-section {
            width: 90%;
            height: 100%;
            display: flex;
            align-items: center;
        }

        #info-panel {
            background-color: #1f1f1f;
            border-radius: 5%;;
            border: solid 5px silver;
            width: 20%;
            height: 40%;
            margin-left: 2%;
            color: #298925;
            font-family: 'Pixelify Sans', sans-serif;
            font-size: 20px;
        }

        #shots-left {
            font-size: 40px;
            margin-left: 55px;;
        }

        #gameboard {
            height: 80%;
            aspect-ratio: 1 / 1;
            background-image: url('assets/gameboard-background.png');
            background-size: cover;
            margin-right: 2%;
            margin-left: 2%;
            border: solid 5px silver;
        }

        .row {
            height: 10%;
        }

        .square {
            display: inline-block;
            height: 100%;
            width:10%;
            border: rgba(0, 0, 0, .4) solid 1px;
            margin: -1px;
        }

        #ship-panel {
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 5%;;
            border: solid 5px silver;
            width: 25%;
            height: 80%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            font: arial;
        }

        .ship-image {
            height: 65px;

        }

        .ship-image-div {
            display: flex;
            justify-content: space-around;
            margin-bottom: 10px;
        }

        .ship-description-div {
            font-size: 14px;
            height: 10px;
            color: black;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            margin-left: 10px;
            margin-right: 10px;
        };


    </style>
</head>


<body>
    <div id="entire">
        <div id="left-side-section">
            <div id="logo-div">
                <img id="logo" src="assets/battle-of-ships-logo.png">
            </div>
        </div>
        <div id="main-section"></div>
    </div>
</body>


<script>

    console.log('script working');

    const mainEl = document.getElementById('main-section')
    console.log(mainEl)
    let infoPanelEl;
    let gameboardEl;
    let shipPanelEl
    let gridObject;
    let orientation;
    let colNum;
    let rowNum;
    let randRow;
    let randCol;
    let noneCount;
    let shipImageDiv;
    let shipImage;
    let shipDescriptionDiv;
    let shipNameP;
    let shipSizeP;
    let shotsLeft;
    const ships = [
        {name: 'Aircraft Carrier', size: 5, image: 'assets/aircraft-carrier.png',},
        {name: 'Battleship', size: 4, image: 'assets/battleship.png',},
        {name: 'Submarine', size: 3, image: 'assets/submarine.png',},
        {name: 'Cruiser', size: 3, image: 'assets/cruiser.png',},
        {name: 'Destroyer', size: 2, image: 'assets/destroyer.png',},
    ];
    
    function initialize() {
        createMainSectionStructure();
        fillInfoPanel();
        fillGameGridAndGridObject();
        placeShips();
        fillShipPanel();
    };

    function clearMainSectionEl() {
        const mainContents = mainEl.querySelectorAll('*');
        mainContents.forEach(element => element.remove());
    }

    function createMainSectionStructure() {
        clearMainSectionEl();
        infoPanelEl = document.createElement('div');
        infoPanelEl.id = "info-panel";
        mainEl.appendChild(infoPanelEl);
        gameboardEl = document.createElement('div');
        gameboardEl.id = "gameboard";
        mainEl.appendChild(gameboardEl);
        shipPanelEl = document.createElement('div')
        shipPanelEl.id = "ship-panel";
        mainEl.appendChild(shipPanelEl);
    };

    function fillInfoPanel() {
    infoPanelEl.innerHTML = "<p>Find And Destroy The Enemy Fleet:<br><br><span id='shots-left'>40</span><br><br>Shots Remaining</p>";
    }


    function fillGameGridAndGridObject() {
        gridObject = {};
        let id = 0;
        for (let i = 1; i <= 10; i++) {
            let rowEl = document.createElement('div');
            rowEl.className = "row";
            gameboardEl.appendChild(rowEl);
            gridObject[i] = {};
            for (let j = 1; j <= 10; j++) {
                let squareEl = document.createElement('div');
                squareEl.className = "square";
                id++;
                squareEl.id = id;
                rowEl.appendChild(squareEl);
                gridObject[i][j] = 'none';
                squareEl.addEventListener('click', () => {
                    gameboardClick(i, j);
                }); 
            };
        };
    };

    function placeShips() {
        for (let ship of ships) {
            findOpenSpot(ship);
        };
    };

    function setOrientation() {
        let random0to1 = Math.floor(Math.random() * 2);
        if (random0to1 == 0) { 
            orientation = "vertical";
        } else if (random0to1 == 1) { 
            orientation = "horizontal";
        };
    }

    function getRandoms(ship) {
        if (orientation == 'vertical') {
            randRow = Math.floor(Math.random() * (10 - ship.size) + 1);
            randCol = Math.floor(Math.random() * 10 + 1);
        } else if (orientation == 'horizontal') {
            randCol = Math.floor(Math.random() * (10 - ship.size) + 1);
            randRow = Math.floor(Math.random() * 10 + 1);
        };
    }

    function findOpenSpot(ship) {
        setOrientation();
        getRandoms(ship);
        noneCount = 0;
        if (orientation == 'vertical') {
            for (let k = 0; k < ship.size; k++) {
                if (gridObject[randRow + k][randCol] == 'none') {
                noneCount++
                };
            };
            if (ship.size == noneCount++) {
                for (let m = 0; m < ship.size; m++) {
                    gridObject[randRow + m][randCol] = ship.name;
                }
            } else {
                findOpenSpot(ship);
            };
        };
        if (orientation == 'horizontal') {
            for (let w = 0; w < ship.size; w++) {
                if (gridObject[randRow][randCol + w] == 'none') {
                noneCount++
                };
            };
            if (ship.size == noneCount++) {
                for (let b = 0; b < ship.size; b++) {
                    gridObject[randRow][randCol + b] = ship.name;
                };
            } else {
                findOpenSpot(ship);
            };   
        };
        console.log(gridObject);
    };


    function fillShipPanel() {
        for (let ship of ships) {
            shipImage = document.createElement('img');
            shipImage.src = ship.image;
            shipImage.className = 'ship-image';
            shipImageDiv = document.createElement('div');
            shipImageDiv.className = 'ship-image-div';
            shipDescriptionDiv = document.createElement('div');
            shipDescriptionDiv.className = 'ship-description-div';
            shipNameP = document.createElement('p');
            shipNameP.innerText = ship.name;
            shipSizeP = document.createElement('p');
            shipSizeP.innerText = 'Size: ' + ship.size;
            shipPanelEl.appendChild(shipDescriptionDiv);
            shipPanelEl.appendChild(shipImageDiv);
            shipDescriptionDiv.appendChild(shipNameP);
            shipDescriptionDiv.appendChild(shipSizeP);
            shipImageDiv.appendChild(shipImage);
        };

    };

    function gameboardClick(squareEl) {

    };


    initialize();

</script>

</html>

