<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pixelify+Sans&display=swap" rel="stylesheet">

    <link rel="icon" href="assets/favicon.png" type="image/png">


    <title>Document</title>

    <style>

        .explosion {
            background-image: url('assets/explosion.jpg');
            background-size: cover;
            background-position: center;
        }

        .red-overlay-div {
            position: absolute;
            height: 85px;
            width: 350px;
        }

        .red {
            background-color: rgb(255, 0, 0, .5);
        }
        

        body {
            background-image: url('assets/fleet-background.jpg');
            background-size: cover;
            width: 99vw;
            height: 97vh;
        }

        #entire {
            width: 1350px;
            height: 540px;
            display: flex;
        }

        #left-side-section {
            width: 90px;;
            height: 550px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #logo-div {
            width: 86px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #logo {
            width: 86px;
        }

        #main-section {
            width: 1300px;
            height: 550px;
            display: flex;
            align-items: center;
        }

        #info-panel {
            background-color: #1f1f1f;
            border-radius: 10px;
            border: solid 5px silver;
            width: 250px;
            height: 200px;
            margin-left: 50px;
            color: #298925;
            font-family: 'Pixelify Sans', sans-serif;
            font-size: 20px;
            text-align: center;
        }

        #shots-left {
            font-size: 40px;
            margin-top: 0;
        }

        #gameboard {
            height: 460px;
            aspect-ratio: 1 / 1;
            background-image: url('assets/gameboard-background.png');
            background-size: cover;
            margin-right: 30px;
            margin-left: 30px;
            border: solid 7px silver;
        }

        .row {
            height: 46px;
        }

        .square {
            display: inline-block;
            height: 44px;
            width: 44px;
            border: rgba(0, 0, 0, .4) solid 1px;
        }

        #ship-panel {
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            border: solid 5px silver;
            width: 350px;
            height: 440px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            font: arial;
        }

        .ship-image {
            height: 65px;
        }

        .ship-image-div {
            display: flex;
            justify-content: space-around;
            margin-bottom: 10px;
            position: relative;
        }

        .ship-description-div {
            font-size: 14px;
            height: 10px;
            color: black;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            margin-left: 10px;
            margin-right: 10px;
        };

    </style>
</head>


<body>
    <div id="entire">
        <div id="left-side-section">
            <div id="logo-div">
                <img id="logo" src="assets/battle-of-ships-logo.png">
            </div>
        </div>
        <div id="main-section"></div>
    </div>

    <audio id="splash" preload="auto">
        <source src="assets/splash.wav" type="audio/wav">
    </audio>
    <audio id="boom" preload="auto">
        <source src="assets/boom.wav" type="audio/wav">
    </audio>
</body>


<script>

    const splash = document.getElementById("splash");
    const boom = document.getElementById("boom");
    const mainEl = document.getElementById('main-section')
    let shotsLeft = 40;
    let infoPanelEl;
    let gameboardEl;
    let shipPanelEl
    let gridObject;
    let orientation;
    let randRow;
    let randCol;
    let noneCount;
    let shipImageDiv;
    let shipImage;
    let shipDescriptionDiv;
    let shipNameP;
    let shipSizeP;
    let redOverlayDiv;
    let clickedSquareID;
    let clickedSquare;
    let ships = []
    
    function initialize() {
        createMainSectionStructure();
        fillInfoPanel();
        fillGameGridAndObjects();
        placeShips();
        fillShipPanel();
    };

    function clearMainSectionEl() {
        const mainContents = mainEl.querySelectorAll('*');
        mainContents.forEach(element => element.remove());
    }

    function createMainSectionStructure() {
        clearMainSectionEl();
        infoPanelEl = document.createElement('div');
        infoPanelEl.id = "info-panel";
        mainEl.appendChild(infoPanelEl);
        gameboardEl = document.createElement('div');
        gameboardEl.id = "gameboard";
        mainEl.appendChild(gameboardEl);
        shipPanelEl = document.createElement('div')
        shipPanelEl.id = "ship-panel";
        mainEl.appendChild(shipPanelEl);
    };

    function fillInfoPanel() {
        let instructionsP = document.createElement('p');
        instructionsP.innerText = 'Find And Destroy The Enemy Fleet';
        infoPanelEl.appendChild(instructionsP);
        let shotsMessage = document.createElement('p');
        shotsMessage.innerText = "Shots Remaining:";
        infoPanelEl.appendChild(shotsMessage);
        let shotsLeftP = document.createElement('p');
        shotsLeftP.id = 'shots-left';
        shotsLeftP.innerText = shotsLeft;
        infoPanelEl.appendChild(shotsLeftP);

    }

    function fillGameGridAndObjects() {
        ships = [
        {name: 'Aircraft Carrier', size: 5, image: 'assets/aircraft-carrier.png', damage: 0},
        {name: 'Battleship', size: 4, image: 'assets/battleship.png', damage: 0},
        {name: 'Submarine', size: 3, image: 'assets/submarine.png', damage: 0},
        {name: 'Cruiser', size: 3, image: 'assets/cruiser.png', damage: 0},
        {name: 'Destroyer', size: 2, image: 'assets/destroyer.png', damage: 0},
        ];
        gridObject = {};
        let id = 0;
        for (let rowNum = 1; rowNum <= 10; rowNum++) {
            let rowEl = document.createElement('div');
            rowEl.className = "row";
            gameboardEl.appendChild(rowEl);
            gridObject[rowNum] = {};
            for (let colNum = 1; colNum <= 10; colNum++) {
                let squareEl = document.createElement('div');
                squareEl.className = "square";
                id++;
                squareEl.id = id;
                rowEl.appendChild(squareEl);
                gridObject[rowNum][colNum] = 'none';
                squareEl.addEventListener('click', (event) => {
                gameboardClick(rowNum, colNum);
                });
            };
        };
    };

    function placeShips() {
        for (let ship of ships) {
            findOpenSpot(ship);
        };
    };

    function setOrientation() {
        let random0to1 = Math.floor(Math.random() * 2);
        if (random0to1 == 0) { 
            orientation = "vertical";
        } else if (random0to1 == 1) { 
            orientation = "horizontal";
        };
    }

    function getRandoms(ship) {
        if (orientation == 'vertical') {
            randRow = Math.floor(Math.random() * (10 - ship.size) + 1);
            randCol = Math.floor(Math.random() * 10 + 1);
        } else if (orientation == 'horizontal') {
            randCol = Math.floor(Math.random() * (10 - ship.size) + 1);
            randRow = Math.floor(Math.random() * 10 + 1);
        };
    }

    function findOpenSpot(ship) {
        setOrientation();
        getRandoms(ship);
        noneCount = 0;
        if (orientation == 'vertical') {
            for (let k = 0; k < ship.size; k++) {
                if (gridObject[randRow + k][randCol] == 'none') {
                noneCount++
                };
            };
            if (ship.size == noneCount++) {
                for (let m = 0; m < ship.size; m++) {
                    gridObject[randRow + m][randCol] = ship.name;
                }
            } else {
                findOpenSpot(ship);
            };
        };
        if (orientation == 'horizontal') {
            for (let w = 0; w < ship.size; w++) {
                if (gridObject[randRow][randCol + w] == 'none') {
                noneCount++
                };
            };
            if (ship.size == noneCount++) {
                for (let b = 0; b < ship.size; b++) {
                    gridObject[randRow][randCol + b] = ship.name;
                };
            } else {
                findOpenSpot(ship);
            };   
        };
    };


    function fillShipPanel() {
        for (let ship of ships) {
            shipImage = document.createElement('img');
            shipImage.src = ship.image;
            shipImage.className = 'ship-image';
            shipImageDiv = document.createElement('div');
            shipImageDiv.className = 'ship-image-div';
            shipDescriptionDiv = document.createElement('div');
            shipDescriptionDiv.className = 'ship-description-div';
            shipNameP = document.createElement('p');
            shipNameP.innerText = ship.name;
            shipSizeP = document.createElement('p');
            shipSizeP.innerText = 'Size: ' + ship.size;
            redOverlayDiv = document.createElement('div');
            redOverlayDiv.className = "red-overlay-div";
            shipPanelEl.appendChild(shipDescriptionDiv);
            shipPanelEl.appendChild(shipImageDiv);
            shipDescriptionDiv.appendChild(shipNameP);
            shipDescriptionDiv.appendChild(shipSizeP);
            shipImageDiv.appendChild(redOverlayDiv);
            shipImageDiv.appendChild(shipImage);
        };

    };

    function gameboardClick(rowNum, colNum) {
        clickedSquare = event.target
        if (gridObject[rowNum][colNum] == 'none') {
            miss(rowNum, colNum, clickedSquare)
        } else if (gridObject[rowNum][colNum] != 'none' && (gridObject[rowNum][colNum] != 'closed')) {
            hit(rowNum, colNum, clickedSquare);
        }
        checkGameStatus();
        let shotsLeftP = document.getElementById('shots-left'); 
        shotsLeftP.innerText = shotsLeft;
    };

    function miss(rowNum, colNum, clickedSquare) {
        gridObject[rowNum][colNum] = 'closed';
        clickedSquare.style.backgroundColor = 'rgba(0, 0, 0, 0.6)';
        shotsLeft--;
        splash.play();
    };

    function hit(rowNum, colNum, clickedSquare) {
        hitShip = gridObject[rowNum][colNum];
        boom.play();
        gridObject[rowNum][colNum] = 'closed';
        clickedSquare.classList.add('explosion');

    }

    function checkGameStatus() {

    };

    initialize();

</script>

</html>

